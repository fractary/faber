{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Configurator Agent Schema",
  "description": "JSON Schema for validating configurator agent frontmatter and structure",
  "properties": {
    "frontmatter": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Agent name in lowercase with hyphens"
        },
        "description": {
          "type": "string",
          "maxLength": 200,
          "description": "Clear, actionable description"
        },
        "model": {
          "type": "string",
          "enum": ["claude-haiku-4-5", "claude-sonnet-4-5", "claude-opus-4-5"],
          "default": "claude-sonnet-4-5",
          "description": "LLM model to use"
        },
        "tools": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["Bash", "Read", "Write", "Edit", "Glob", "Grep", "AskUserQuestion", "Skill", "WebFetch", "WebSearch"]
          },
          "contains": {
            "const": "AskUserQuestion"
          },
          "description": "Tools available to the agent. MUST include AskUserQuestion for configurators."
        },
        "color": {
          "type": "string",
          "pattern": "^(red|orange|yellow|green|blue|purple|pink|gray|cyan)$",
          "description": "Optional color for visual identification"
        }
      },
      "required": ["name", "description", "model", "tools"]
    },
    "sections": {
      "type": "object",
      "properties": {
        "context": {
          "type": "boolean",
          "const": true,
          "description": "CONTEXT section is required"
        },
        "argument_syntax": {
          "type": "boolean",
          "const": true,
          "description": "ARGUMENT_SYNTAX section is required"
        },
        "critical_rules": {
          "type": "boolean",
          "const": true,
          "description": "CRITICAL_RULES section is required"
        },
        "implementation": {
          "type": "boolean",
          "const": true,
          "description": "IMPLEMENTATION section is required"
        },
        "outputs": {
          "type": "boolean",
          "const": true,
          "description": "OUTPUTS section is required"
        },
        "input_validation": {
          "type": "boolean",
          "description": "INPUT_VALIDATION section is recommended"
        },
        "error_handling": {
          "type": "boolean",
          "description": "ERROR_HANDLING section is recommended"
        }
      },
      "required": ["context", "argument_syntax", "critical_rules", "implementation", "outputs"]
    },
    "implementation_steps": {
      "type": "array",
      "description": "Required implementation steps for configurators",
      "items": {
        "type": "string"
      },
      "minItems": 6,
      "contains": {
        "anyOf": [
          { "pattern": "(?i)check.*existing|detect.*config" },
          { "pattern": "(?i)auto.*detect|detect.*value" },
          { "pattern": "(?i)confirm|interactive|ask.*user" },
          { "pattern": "(?i)preview|display.*change" },
          { "pattern": "(?i)backup|save.*state" },
          { "pattern": "(?i)apply|write|save" },
          { "pattern": "(?i)validate|verify" }
        ]
      }
    }
  },
  "required": ["frontmatter", "sections"]
}
